<!DOCTYPE html>
<html class="light" lang="ko">
<head>
  <%- include('../partials/head') %>
  <title>로그인 | Campus flea Market</title>
</head>
<body class="font-display bg-main text-text-light dark:text-text-dark">
  <div class="relative flex h-auto min-h-screen w-full flex-col group/design-root overflow-x-hidden">
    <div class="layout-container flex h-full grow flex-col">
      <!-- 메인 콘텐츠 -->
      <main class="auth-container">
        <div class="auth-slider-container <%= typeof showJoinForm !== 'undefined' && showJoinForm ? 'show-join' : '' %>">
          <!-- 개인 공부용 설명 -->
          
          <!--
          EJS 태그 설명:
          
          1. <%= %> : 서버에서 전달된 변수를 HTML에 출력하는 EJS 태그
            - 컨트롤러에서 res.render('auth/login', { showJoinForm: true })로 전달한 데이터를 사용
            - 결과가 문자열로 렌더링되어 HTML에 삽입됨
          
          typeof showJoinForm !== 'undefined' && showJoinForm ? 'show-join' : ''
            -삼항연산자다 복잡할 것 없음
            -showJoinForm이 true면 'show-join' 반환, false면 빈 문자열 반환
          
          최종 결과:
          - showJoinForm이 true → class="auth-slider-container show-join"
          - showJoinForm이 false 또는 없음 → class="auth-slider-container "
          
          auth-slider-container show-join 이건 뭐 어디있는 건가?

          내 답변:css파일에 있는 거임
              css에 이미 만들어놓은 선택자가 있음 
              .auth-slider-container.show-join .auth-card-login
              .auth-slider-container.show-join .auth-card-join
              이런식으로
          -->
          
          <!-- 로그인 카드 -->
          <div class="auth-card auth-card-login">
            <div class="auth-card-content">
              <!-- 로그인 폼 제목 -->
              <h1 class="auth-title">로그인</h1>
              <form class="auth-form" action="/auth/login" method="POST">
                <!-- 원래 가려던 페이지 저장 (로그인 후 리다이렉트용) -->
                <% if (typeof returnTo !== 'undefined' && returnTo) { %>
                <input type="hidden" name="returnTo" value="<%= returnTo %>"/>
                <% } %>
                <div class="auth-form-group">
                  <!-- 이메일 입력 -->
                  <label class="auth-label">
                    <p class="auth-label-text">이메일</p>
                    <input class="auth-input" placeholder="이메일 주소를 입력하세요" type="email" name="email" value="<%= typeof email !== 'undefined' ? email : '' %>" required/>
                  </label>
                  <!-- 비밀번호 입력 -->
                  <label class="auth-label">
                    <p class="auth-label-text">비밀번호</p>
                    <div class="auth-input-wrapper">
                      <input class="auth-input auth-input-password" placeholder="비밀번호를 입력하세요" type="password" name="password" required/>
                      <!-- 비밀번호 표시/숨김 버튼 -->
                      <button class="password-toggle-button auth-password-toggle" type="button">
                        <span class="material-symbols-outlined">visibility_off</span>
                      </button>
                    </div>
                  </label>
                </div>
                <!-- 에러 메시지 -->
                <% if (typeof error !== 'undefined' && error) { %>
                <div class="auth-error">
                  <p class="auth-error-message"><%= error %></p>
                </div>
                <% } else { %>
                <div class="auth-error">
                  <p class="auth-error-message"></p>
                </div>
                <% } %>
                <!-- 성공 메시지 (회원가입 성공 시 표시) -->
                <% if (typeof success !== 'undefined' && success) { %>
                <div class="auth-success" style="color: green; margin-top: 10px; padding: 10px; background-color: #f0f9ff; border-radius: 4px;">
                  <p><%= success %></p>
                </div>
                <% } %>
                <!-- 로그인 버튼 -->
                <button class="auth-submit-button" type="submit">로그인</button>
              </form>
              <!-- 회원가입 링크 -->
              <div class="auth-link-section">
                <p class="auth-link-text">
                  아직 회원이 아니신가요? <a class="auth-link" href="#" id="show-join-form">회원가입</a>
                </p>
              </div>
            </div>
          </div>
          
          <!-- 회원가입 카드 -->
          <div class="auth-card auth-card-join">
            <div class="auth-card-content">
              <!-- 회원가입 폼 제목 -->
              <h1 class="auth-title">회원가입</h1>
              <form class="auth-form" id="join-form" action="/auth/join" method="POST">
                <div class="auth-form-group">
                  <!-- 이름 입력 -->
                  <label class="auth-label">
                    <p class="auth-label-text">이름</p>
                    <input class="auth-input" placeholder="이름을 입력하세요" type="text" name="name" required/>
                  </label>
                  <!-- 이메일 입력 -->
                  <label class="auth-label">
                    <p class="auth-label-text">이메일</p>
                    <input class="auth-input" placeholder="이메일 주소를 입력하세요" type="email" name="email" required/>
                  </label>
                  <!-- 비밀번호 입력 -->
                  <label class="auth-label">
                    <p class="auth-label-text">비밀번호</p>
                    <div class="auth-input-wrapper">
                      <input class="auth-input auth-input-password" placeholder="비밀번호를 입력하세요" type="password" name="password" required/>
                      <!-- 비밀번호 표시/숨김 버튼 -->
                      <button class="password-toggle-button auth-password-toggle" type="button">
                        <span class="material-symbols-outlined">visibility_off</span>
                      </button>
                    </div>
                  </label>
                  <!-- 비밀번호 확인 입력 -->
                  <label class="auth-label">
                    <p class="auth-label-text">비밀번호 확인</p>
                    <div class="auth-input-wrapper">
                      <input class="auth-input auth-input-password" placeholder="비밀번호를 다시 입력하세요" type="password" name="passwordConfirm" required/>
                      <!-- 비밀번호 표시/숨김 버튼 -->
                      <button class="password-toggle-button auth-password-toggle" type="button">
                        <span class="material-symbols-outlined">visibility_off</span>
                      </button>
                    </div>
                  </label>
                  <!-- 대학교 입력 -->
                  <label class="auth-label">
                    <p class="auth-label-text">대학교</p>
                    <input class="auth-input" placeholder="예: 부산대학교" type="text" name="campus"/>
                  </label>
                </div>
                <!-- 에러 메시지 -->
                <div class="auth-error">
                  <p class="auth-error-message" id="join-error-message"></p>
                </div>
                <!-- 완료/취소 버튼 -->
                <div class="auth-form-actions">
                  <button type="button" class="auth-cancel-button" id="cancel-join-form">취소</button>
                  <button type="submit" class="auth-submit-button">완료</button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </main>
    </div>
  </div>
  <!-- auth.js가 Utils 객체를 사용해서 common.js를 먼저 로드 -->
  <script src="/js/common.js"></script>
  <!-- auth.js 로드 -->
  <script src="/js/auth.js"></script>
</body>
</html>
