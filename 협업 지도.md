## 1. 역할 분담의 핵심 (Balance Point)

### Dev A: robinhood0107

### Dev B: gangje


두 개발자가 **백엔드 로직 복잡도**와 **프론트엔드 작업량**을 공평하게 나누는 것이 핵심입니다.

| 구분 | **Dev A: 사이트 골격 & 사용자 (User & System)** | **Dev B: 핵심 콘텐츠 & 인터랙션 (Commerce & Feature)** |
| :--- | :--- | :--- |
| **난이도 상 (Hard)** | **Passport 인증 & 세션:** 보안 설정, 로그인 유지 로직 복잡함. | **Multer & 동적 쿼리:** 이미지 업로드 처리와 검색 필터 SQL 작성 복잡함. |
| **난이도 중 (Medium)** | **관리자 대시보드:** 데이터 집계(Count) 및 테이블 관리. | **비동기(AJAX) 통신:** 찜하기, 상태 변경 시 화면 깜빡임 없는 처리. |
| **View 작업** | **공통 레이아웃(Header):** 로그인 상태에 따른 버튼 분기(`if user`) 처리가 핵심. **상품 상세/목록:** 카드형 UI 디자인 및 이미지 슬라이더 구현.| 관련 ejs 수정 및 호환 |
| **담당 DB** | `users`, `sessions` | `products`, `product_images`, `likes` |

---

## 2. 일자별 상세 가이드 (7-Day Sprint Plan)

디렉터리 구조에 맞춰 **누가(Who), 어떤 파일(Where)을, 어떻게(How)** 개발해야 하는지 구체적으로 명시

#### **Day 1: 환경 설정 및 기반 다지기 (Dev A - robinhood0107가 함)**
* **목표:** 더미데이터를 설정해서 test-server.js로 서버가 켜지고, DB가 연결되어야 함.
* **Dev A (서버 & 뷰 골격 및 DB & 모델링): (초기세팅으로 꽤 복잡)**
    * ~~`bin/www`: 포트(3000) 설정 및 서버 실행 스크립트 작성.~~
        * app.js에 전부 모았음(robinhood0107)
    * `app.js`: 미들웨어(`express.json`, `static`) 설정 및 라우터 연결 준비.
    * `views/partials/`: `header.ejs`, `footer.ejs`, `head.ejs` 생성 및 기본 HTML 코딩.
    * `config/db.js`: `mysql2/promise`를 이용한 Connection Pool 생성.
    * **DB 구축:** 제공된 `schema.sql`을 실행하여 테이블 생성 및 FK 제약조건 확인.
    * `models/`: `User.js`, `Product.js` 파일 생성 (SQL 쿼리를 담을 뼈대).
    * 모든 html을 ejs에 맞도록 전부 수정 및 header footer 등등 충돌 방지를 위해 작업
    (이 작업이 젤 오래걸림-robinhood0107)
    * **Frontend:** `views/product/list.ejs` (Grid 레이아웃), `views/product/detail.ejs` (상세 정보 표시).

#### **Day 2: 인증 시스템(A) vs 상품 등록(B) - [가장 중요]**
* **Dev A (세션/접근제어 & 인증 - Auth & 마이페이지 - Personal):**

    >**주말인 관계로 Day 2에 `Day 2`, `Day 3`, `Day 4 일부` 것까지 크런치를 진행**

    * **Middleware:** `middlewares/isAuthenticated.js` (비로그인 접근 차단).
    * **Backend:** 
      - `config/passport.js` 작성 (LocalStrategy). `controllers/authController.js`에 회원가입(bcrypt 암호화), 로그인 로직 구현.
      - `controllers/userController.js`. 내 정보 조회, **내가 등록한 상품 조회**, **내가 찜한 상품 조회(JOIN likes)** 쿼리 작성.
      - `models\Product.js`, `models\User.js` sql 구문 전부 완성 및 검색 sql, 필터링 조회 생성 등등 여러 필요한 sql 완성 (sql 구문 활용만 하면 됨)
    * **Frontend:** 
        - `views/auth/login.ejs` --> 회원가입, 로그인 전부 총괄
        - 프로필 수정 버튼의 `modal(모달)` 기능 구현(이메일을 제외한)
        - `views/user/profile-edit-modal.ejs`, `views/user/profile.ejs` 구현
        - `views/user/profile.ejs`의 탭(Tab) UI를 이용해 판매 내역과 찜 목록 구분 표시.
    * **Route:** 라우터 전부 구현 (`adminRoutes.js`, `authRoutes.js`, `index.js`, `productRoutes.js`, `userRoutes.js`)


    * **View Logic:** `header.ejs` 수정. `<% if (user) { %>` 로그아웃/마이페이지 `<% } else { %>` 로그인/가입 버튼 노출 로직 완성.


    * 건드린 것이 꽤 많아서 자세한 것은 **commit**과 **Pull request** 참고
    
* **Dev B (상품 등록 - Upload):**
    * **Backend:** `middlewares/upload.js` 작성 (Multer 설정, 파일명 중복 방지, 확장자 제한).
    * **Frontend:** `views/product/write.ejs` 수정 (`enctype="multipart/form-data"` 필수).
    

#### **Day 3: 목록/상세 조회(B)**
* **Dev A (SQL 쿼리문 수정):**
    * **Script:** - `models\Product.js`, `models\User.js` 검색 및 통계 부분까지 염두해서 추가 작성. 검색어(keyword)와 카테고리(category) 유무에 따라 SQL `WHERE`절을 동적으로 생성하는 로직 구현 (SQL Injection 방지 필수).

* **Dev B (조회 - Read):**
    * **Backend:** `controllers/productController.js`의 `getProducts`(목록), `getProductDetail`(상세) 구현. 상세 조회 시 `LEFT JOIN users`로 판매자 정보까지 가져오기.
        > `models\Product.js`, `models\User.js` sql 쿼리 promise 함수 사용하도록 하세요. 여기에 전부 쿼리문 구현되어 있습니다. 혹시 이상하다면 여기에서 쿼리문 수정해주시면 됩니다. **(robinhood0107)**

#### **Day 4: 마이페이지(A) vs 인터랙션(B)**
* **Dev A (마이페이지 - Personal):**
    * **추가 요구사항**: 
      - [마이페이지] 프로필 이미지 수정기능 `upload.js` 완성 이후 제작
      - [마이페이지] 마이페이지에서 판매중인 물건 삭제 기능 `productController.js` 완성 이후 구현
    
* **Dev B (상호작용 - AJAX):**
    * (중요) 필수 목표 : `productController.js` 완성 (검색기능)
    * **Script:** `public/js/product.js`에 이미지 미리보기(Preview) 기능 구현.
    * **Backend:** `productController.js`에 찜 토글(`toggleLike`), 판매 상태 변경(`updateStatus`) API 구현 (JSON 응답).
    * **Frontend:** `public/js/product.js`. `fetch()` 함수를 사용하여 페이지 새로고침 없이 하트 아이콘 채우기 및 상태 뱃지 변경 구현.

#### **Day 5: 관리자 페이지 및 상품 전체 페이지 최종 완성(B) -**
* **Dev B (관리자 페이지):**
    * **Middleware:** `middlewares/isAdmin.js` (`req.user.isAdmin` 체크).
    * **Backend:** `controllers/adminController.js`. 전체 회원 목록/상품 목록 조회 및 삭제(`DELETE`) 로직.
    - [관리자페이지] 관리자의 경우만 `header.ejs`에서 관리 페이지로 이동할 수 있는 버튼 생성 
    * **Frontend:** `header.ejs`의 검색 Form과 `list.ejs`의 카테고리 링크 연동. `productController.js` 수정은 필요하다면.


#### **Day 6: 통합 테스트(Cross-Check) 및 품질 향상**
* **Dev A:** B가 만든 '상품 등록 -> 상세 조회 -> 찜하기' 흐름 테스트하며 버그 리포트.
* **Dev B:** A가 만든 '회원가입 -> 로그인 -> 관리자 페이지' 흐름 테스트.
* **공통:** JSDoc 주석 작성 (평가 점수 5점 확보). 코드 리팩토링 (중복 제거).

#### **Day 7: 최종 산출물 및 배포 준비**
* **Dev B:** 최종 보고서 작성 (아키텍처, 인증 로직 설명).
            시연 영상 시나리오 기획 및 녹화 (상품 등록부터 구매 완료까지).
* **공통:** `README.md` 작성 및 최종 DB 덤프(`schema.sql`) 추출.

#### **최종 마무리 날짜는 12월 7일 일요일을 넘어가서는 안된다.**

---

## 3. 협업 꿀팁 (Conflict 방지)
1.  **`app.js`는 A가 관리:** 라우터를 연결하는 코드는 Dev A가 취합하여 작성하는 것이 충돌을 줄입니다. B는 라우터 파일(`productRoutes.js`)만 잘 만들어서 넘겨주세요.

2.  **`header.ejs` 소유권:** 헤더는 모든 페이지에 뜨기 때문에 수정 충돌이 잦습니다. 기본 뼈대와 로그인 로직은 A가 잡고, 검색창 폼(`form`)만 B가 A에게 코드를 전달하거나 나중에 합치세요.

3.  **DB 변경 금지:** 초기에 합의된 `schema.sql` 외에 컬럼을 추가해야 한다면 반드시 상의 후 `schema.sql`을 업데이트하고 팀원에게 알려야 합니다.


## 파일 구조

```text
/my-ecommerce-app
├── bin/
│   └── www                  # 포트(3000) 설정 및 서버 실행 (app.listen 분리)
├── config/
│   ├── db.js                # [중요] mysql2 Connection Pool 설정 
│   └── passport.js          # 로그인 전략 (Dev A 담당)
├── controllers/             # [핵심] 비즈니스 로직
│   ├── authController.js
│   ├── productController.js
│   ├── userController.js
│   └── adminController.js   
├── models/                  # DB 쿼리 (SQL)
│   ├── User.js
│   └── Product.js
├── routes/                  # URL 주소 정의
│   ├── authRoutes.js        # /auth/login, /auth/join 등
│   ├── productRoutes.js     # /product/list, /product/write 등
│   ├── userRoutes.js        # /user/profile 등
│   ├── adminRoutes.js       # /admin/dashboard 등
│   └── index.js             # 메인 홈 (/) 라우터
├── middlewares/
│   ├── isAuthenticated.js   # 로그인 여부 체크 
│   ├── isAdmin.js           # 관리자 권한 체크 
│   └── upload.js            # Multer 이미지 업로드 설정 
├── public/                  # 정적 파일
│   ├── css/
│   ├── js/                  # (프론트엔드용) common.js, product.js 
│   └── uploads/             # 이미지 저장 폴더
├── views/                   # EJS 템플릿 파일
│   ├── partials/            # header.ejs, footer.ejs, head.ejs, profile-edit-modal.ejs(profile용 모달)
│   ├── auth/                # login.ejs
│   ├── product/             # list.ejs, detail.ejs, write.ejs, edit.ejs
│   ├── user/                # profile.ejs
│   └── admin/               # 추가 필수: dashboard.ejs
├── .env                     # DB 비밀번호 등 (절대 Git 업로드 금지) 
├── app.js                   # 미들웨어 장착 및 라우터 연결
├── package.json
└── README.md
```
